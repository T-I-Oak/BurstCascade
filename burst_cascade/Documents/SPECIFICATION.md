# BURST CASCADE 仕様書

## 1. 基本情報
- **アプリ名**: BURST CASCADE (バースト・カスケード)
- **バージョン**: 4.5.2
- **ジャンル**: 連鎖爆発ストラテジー
- **概要**:
  純粋なエネルギーの結晶体「ヘキサグリッド」を舞台に、エネルギーの注入と爆発（Burst）、そして連鎖（Cascade）を駆使して、対立する勢力の「共鳴中枢（Core）」を奪還・無効化する戦略ゲーム。

## 2. ゲームルール

### 勝利条件
相手勢力がマップ中に保有している **「共鳴中枢（Core）」** をすべて **無効化** することで勝利となる。
- 自勢力のエネルギーを注入して中和、または爆発（Burst）させることで無効化可能。

### ターン進行
ゲームはターン制で進行し、各ターンは以下のフェーズで構成される。

1.  **エネルギー注入フェーズ (Injection)**
    - 自勢力のグリッドを選択し、エネルギーを注入する。
    - 注入の結果、 **爆発（Burst）** や **共鳴（Resonance）** が発生する。
2.  **供給エネルギー再構築フェーズ (Reconstruction)**
    - アクション終了後、7つの供給エネルギーのうちランダムな2つが選ばれて再構築（±1）される。
    - **爆発未発生時 (集束/Focus)**: エネルギー差が開くように変化（例: 2と4 → 1と5）。
    - **爆発発生時 (拡散/Diffuse)**: エネルギー差が縮まるように変化（例: 1と5 → 2と4）。
3.  **ターン継続チェックフェーズ (Check)**
    - **停滞 (Stagnation)**: 爆発なし → **ターン終了（交代）**
    - **飽和 (Saturation)**: 共鳴による供給エネルギー強化発生 → **ターン終了（交代）**
    - **連鎖 (Cascade)**: 爆発あり、かつ飽和せず → **ターン継続（再注入可能）**

### アクション詳細

#### 爆発 (Burst)
- グリッドのエネルギーが限界（ **9** ）を超えた場合に発生。
- 蓄積エネルギーを放出し、グリッドは基底状態（0）に戻る。
- そのグリッドの共鳴中枢（Core）は無効化される。

#### 共鳴 (Resonance)
爆発の発生回数に応じて発動する効果。
- **供給エネルギー強化**: 1ターン中に自勢力の爆発が **4回** 発生すると、供給エネルギーがランダムに+1強化される（ターン終了）。
- **共鳴中枢（Core）追加**: 相手勢力の爆発が通算 **2回** 発生するたびに、共鳴中枢がランダムに1つ追加される。

## 3. 機能一覧

### ゲーム設定
- **PLAYERS**:
  - **1P vs CPU (PvC)**: プレイヤー対AI
  - **2P LOCAL (PvP)**: ローカル対戦
- **AI LEVEL** (PvCのみ):
  - **EASY**
  - **NORMAL**
  - **HARD**
- **MAP SIZE**:
  - **MINI**
  - **REGULAR**

### 実績システム (Achievements)
- ゲームプレイを通じて解除される実績機能。
- 難易度（EASY/NORMAL/HARD）ごとに達成状況を記録。
- 進捗率表示機能あり。

### 演出・機能
- **Web Audio API** による効果音（配置、爆発、報酬、ターン交代）。
- **アニメーション**: 落下エフェクト、リプルエフェクト、回路風AI思考中演出。
- **Peek Board**: ゲームオーバー後などのオーバーレイ表示中に盤面を確認する機能。

## 4. 技術スタック
- **Frontend**: HTML5, CSS3, Vanilla JavaScript (ES6 Modules)
- **Sound**: Web Audio API
- **Testing**: Jest (jsdom environment)

## 5. ファイル構成概要
- `index.html`: エントリーポイント、UI構造
- `burst_cascade/`
  - `main.js`: ゲームループ、イベントハンドリング、Gameクラス
  - `map.js`: HexMapクラス（盤面管理）
  - `ai.js`: AIロジック
  - `achievements.js`: 実績管理
  - `tutorial.js`: チュートリアル・ヘルプ描画
  - `style.css`: ゲームスタイル定義
  - `achievement_style.css`: 実績画面スタイル
  - `Documents/`: ドキュメント格納
  - `Tests/`: テストコード
